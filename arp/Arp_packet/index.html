<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Arp_packet (arp.Arp_packet)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">arp</a> &#x00BB; Arp_packet</nav><h1>Module <code>Arp_packet</code></h1><p>Conversion between wire and high-level data</p><p>The <a href="index.html#type-t"><span>high-level datatype</span></a> can be decoded and encoded to bytes to be sent on the wire. ARP specifies hardware and protocol addresses, but this implementation picks Ethernet and IPv4 statically. While decoding can result in an error, encoding can not.</p><nav class="toc"><ul><li><a href="#decoding">Decoding</a></li><li><a href="#encoding">Encoding</a></li></ul></nav></header><dl><dt class="spec type" id="type-op"><a href="#type-op" class="anchor"></a><code><span class="keyword">type</span> op</code><code> = </code><table class="variant"><tr id="type-op.Request" class="anchored"><td class="def constructor"><a href="#type-op.Request" class="anchor"></a><code>| </code><code><span class="constructor">Request</span></code></td></tr><tr id="type-op.Reply" class="anchored"><td class="def constructor"><a href="#type-op.Reply" class="anchor"></a><code>| </code><code><span class="constructor">Reply</span></code></td></tr></table></dt></dl><dl><dt class="spec value" id="val-op_to_int"><a href="#val-op_to_int" class="anchor"></a><code><span class="keyword">val</span> op_to_int : <a href="index.html#type-op">op</a> <span>&#45;&gt;</span> int</code></dt><dt class="spec value" id="val-int_to_op"><a href="#val-int_to_op" class="anchor"></a><code><span class="keyword">val</span> int_to_op : int <span>&#45;&gt;</span> <span><a href="index.html#type-op">op</a> option</span></code></dt></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = </code><code>{</code><table class="record"><tr id="type-t.operation" class="anchored"><td class="def field"><a href="#type-t.operation" class="anchor"></a><code>operation : <a href="index.html#type-op">op</a>;</code></td></tr><tr id="type-t.source_mac" class="anchored"><td class="def field"><a href="#type-t.source_mac" class="anchor"></a><code>source_mac : Macaddr.t;</code></td></tr><tr id="type-t.source_ip" class="anchored"><td class="def field"><a href="#type-t.source_ip" class="anchor"></a><code>source_ip : Ipaddr.V4.t;</code></td></tr><tr id="type-t.target_mac" class="anchored"><td class="def field"><a href="#type-t.target_mac" class="anchor"></a><code>target_mac : Macaddr.t;</code></td></tr><tr id="type-t.target_ip" class="anchored"><td class="def field"><a href="#type-t.target_ip" class="anchor"></a><code>target_ip : Ipaddr.V4.t;</code></td></tr></table><code>}</code></dt><dd><p>The high-level ARP frame consisting of the two address pairs and an operation.</p></dd></dl><dl><dt class="spec value" id="val-size"><a href="#val-size" class="anchor"></a><code><span class="keyword">val</span> size : int</code></dt><dd><p><code>size</code> is the size of an ARP frame.</p></dd></dl><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : Stdlib.Format.formatter <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp ppf t</code> prints the frame <code>t</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>equal a b</code> returns <code>true</code> if frames <code>a</code> and <code>b</code> are equal, <code>false</code> otherwise.</p></dd></dl><dl><dt class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><code><span class="keyword">type</span> error</code><code> = </code><table class="variant"><tr id="type-error.Too_short" class="anchored"><td class="def constructor"><a href="#type-error.Too_short" class="anchor"></a><code>| </code><code><span class="constructor">Too_short</span></code></td></tr><tr id="type-error.Unusable" class="anchored"><td class="def constructor"><a href="#type-error.Unusable" class="anchor"></a><code>| </code><code><span class="constructor">Unusable</span></code></td></tr><tr id="type-error.Unknown_operation" class="anchored"><td class="def constructor"><a href="#type-error.Unknown_operation" class="anchor"></a><code>| </code><code><span class="constructor">Unknown_operation</span> <span class="keyword">of</span> Cstruct.uint16</code></td></tr></table></dt><dd><p>The type of possible errors during decoding</p><ul><li><code>Too_short</code> if the provided buffer is not long enough</li><li><code>Unusable</code> if the protocol or hardware address type is not IPv4 and Ethernet</li><li><code>Unknown_operation</code> if it is neither a request nor a reply</li></ul></dd></dl><dl><dt class="spec value" id="val-pp_error"><a href="#val-pp_error" class="anchor"></a><code><span class="keyword">val</span> pp_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <a href="index.html#type-error">error</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp_error ppf err</code> prints the error <code>err</code> on <code>ppf</code>.</p></dd></dl><section><header><h3 id="decoding"><a href="#decoding" class="anchor"></a>Decoding</h3></header><dl><dt class="spec value" id="val-decode"><a href="#val-decode" class="anchor"></a><code><span class="keyword">val</span> decode : Cstruct.t <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p><code>decode buf</code> attempts to decode the buffer into an ARP frame <code>t</code>.</p></dd></dl></section><section><header><h3 id="encoding"><a href="#encoding" class="anchor"></a>Encoding</h3></header><dl><dt class="spec value" id="val-encode"><a href="#val-encode" class="anchor"></a><code><span class="keyword">val</span> encode : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>encode t</code> is a <code>buf</code>, a freshly allocated buffer, which contains the encoded ARP frame <code>t</code>.</p></dd></dl><dl><dt class="spec value" id="val-encode_into"><a href="#val-encode_into" class="anchor"></a><code><span class="keyword">val</span> encode_into : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> unit</code></dt><dd><p><code>encode_into t buf</code> encodes <code>t</code> into the buffer <code>buf</code> at offset 0.</p><dl><dt>raises Invalid_argument</dt><dd><p>if the buffer <code>buf</code> is too small (below 28 bytes).</p></dd></dl></dd></dl></section></div></body></html>